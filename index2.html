<!DOCTYPE html>
<html>
	<head>
	</head>
	<body>
		<h1>Testing Socket.io</h1>

		<input id="roomId" placeholder="roomId" />
		<input id="username" placeholder="username" />

		<input id="userId" placeholder="userId" />
		<input id="isUploader" placeholder="isUploader" />
		
		<button id="connect">Connect</button>
		<button id="diconnect">Disconnect</button>

		<br><p>

		<input id="message" placeholder="message" />
		<button id="send">Send</button>
		<button id="clear">Clear</button>
		
		<div id="output"></div>

		<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			var outputDiv = document.getElementById('output');

			/*

			$.post('/user/1/room', {
				yepid: 1,
			}).then(function(data){
				console.log(data);
			}, function(){
				console.log('err');
			});	

			*/

			var socket = io('http://localhost:3000');

			/*
			socket.on('server:error', function(data){
				$('#output').append('<br> Server Error: ' + data.error);
			});
			*/


			socket.on('message', function(data){
				console.log('get');
				var userId = data.userId ? 'user ' + data.userId + ': ' : '';

				$('#output').append('<br>' + userId + data.message);
				/*
				for(var i = 0; i < data.messages.length; i++){
					var message = data.messages[i];
					console.log(message);
					$('#output').append(message.message + "<br>");
				}
				*/
			});

			/*
			socket.on('server:message', function(data){
				$('#output').append(data.message);
			});
			*/		
	

			$('#connect').click(function(){
				//console.log('connecting');
				var roomId = $('#roomId').val();
				var username = $('#username').val();
				var userId = $('#userId').val();
				var isUploader = $('#isUploader').val();

				socket.emit('join_room', {
					roomId:roomId,
					username:username,
					userId:userId,
					isUploader:isUploader
				});
			});

			$('#send').click(function(){
				var message = $('#message').val();
				var userId = $('#userId').val();
				var room = $('#roomId').val();
				var message = {
					message:message,
					userId:userId,
					room:room
				}
				socket.emit('message', message);
				//$('#output').append('<br>' + 'You: ' + message.message);
			});

			$('#diconnect').click(function(){
				socket.emit('client:leave', 'xx');
			});

			$('#clear').click(function(){
				$('#output').empty();
			});

		</script>
	</body>
</html>

<!DOCTYPE html>
<html>
	<head>
	</head>
	<body>
		<h1>Testing Socket.io</h1>

		<input id="channel" placeholder="channel" />
		<input id="token" placeholder="token" />
		
		<button id="connect">Connect</button>
		<button id="diconnect">Disconnect</button>

		<br><p>

		<input id="message" placeholder="message" />
		<button id="send">Send</button>
		<button id="clear">Clear</button>
		
		<div id="output"></div>

		<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			var outputDiv = document.getElementById('output');

			/*

			$.post('/user/1/room', {
				yepid: 1,
			}).then(function(data){
				console.log(data);
			}, function(){
				console.log('err');
			});	

			*/

			var socket = io('http://localhost:3000');

			socket.on('server:error', function(data){
				$('#output').append('<br> Server Error: ' + data.error);
			});

			socket.on('server:messages', function(data){
				var userID = data.userID ? 'user ' + data.userID + ': ' : '';

				$('#output').append('<br>' + userID + data.message);
				/*
				for(var i = 0; i < data.messages.length; i++){
					var message = data.messages[i];
					console.log(message);
					$('#output').append(message.message + "<br>");
				}
				*/
			});

			/*
			socket.on('server:message', function(data){
				$('#output').append(data.message);
			});
			*/		
	

			$('#connect').click(function(){
				//console.log('connecting');
				var channelID = $('#channel').val();
				var token = $('#token').val();
				socket.emit('client:join', {
					room:channelID,
					token:token	
				});
			});

			$('#send').click(function(){
				var message = $('#message').val();
				socket.emit('client:message', {message: message});
				$('#output').append('<br>' + 'You: ' + message);
			});

			$('#diconnect').click(function(){
				socket.emit('client:leave', 'xx');
			});

			$('#clear').click(function(){
				$('#output').empty();
			});

		</script>
	</body>
</html>
